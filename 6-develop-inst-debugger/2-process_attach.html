
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>6.2 进程attach · GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-intopic-toc/style.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-splitter/splitter.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search-pro/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="3-process_start_attach.html" />
    
    
    <link rel="prev" href="1-process_start.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    1 介绍
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../2-preface/">
            
                <a href="../2-preface/">
            
                    
                    2 前言
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../3-terms/">
            
                <a href="../3-terms/">
            
                    
                    3 常用术语
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../4-basics/">
            
                <a href="../4-basics/">
            
                    
                    4 软件调试基础
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../4-basics/1-purposes.html">
            
                <a href="../4-basics/1-purposes.html">
            
                    
                    4.1 调试目的
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../4-basics/2-dependencies.html">
            
                <a href="../4-basics/2-dependencies.html">
            
                    
                    4.2 调试依赖
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../4-basics/3-countertactics.html">
            
                <a href="../4-basics/3-countertactics.html">
            
                    
                    4.3 反调试技术
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../5-debugger-skeleton/">
            
                <a href="../5-debugger-skeleton/">
            
                    
                    5 走进调试器开发
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../5-debugger-skeleton/1-debugger_skeleton.html">
            
                <a href="../5-debugger-skeleton/1-debugger_skeleton.html">
            
                    
                    5.1 调试器雏形 - 功能分析
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../5-debugger-skeleton/1-debugger_skeleton.html">
            
                <a href="../5-debugger-skeleton/1-debugger_skeleton.html">
            
                    
                    5.2 调试器雏形 - 技术方案
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="../5-debugger-skeleton/1-debugger_skeleton.html">
            
                <a href="../5-debugger-skeleton/1-debugger_skeleton.html">
            
                    
                    5.3 调试器雏形 - 落地方案
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="../5-debugger-skeleton/4-debugger_demo.html">
            
                <a href="../5-debugger-skeleton/4-debugger_demo.html">
            
                    
                    5.4 调试器雏形 - demos
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="./">
            
                <a href="./">
            
                    
                    6 开发go指令级调试器
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="1-process_start.html">
            
                <a href="1-process_start.html">
            
                    
                    6.1 进程启动
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.6.2" data-path="2-process_attach.html">
            
                <a href="2-process_attach.html">
            
                    
                    6.2 进程attach
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="3-process_start_attach.html">
            
                <a href="3-process_start_attach.html">
            
                    
                    6.3 启动&attach
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4" data-path="4-debug-session.html">
            
                <a href="4-debug-session.html">
            
                    
                    6.4 调试会话
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.5" data-path="5-disassemble.html">
            
                <a href="5-disassemble.html">
            
                    
                    6.5 反汇编
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.6" data-path="6-breakpoint.html">
            
                <a href="6-breakpoint.html">
            
                    
                    6.6 添加断点
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.7" data-path="7-breakpoints.html">
            
                <a href="7-breakpoints.html">
            
                    
                    6.7 列出断点
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.8" data-path="8-clear.html">
            
                <a href="8-clear.html">
            
                    
                    6.8 移除断点
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.9" data-path="9-clearall.html">
            
                <a href="9-clearall.html">
            
                    
                    6.9 清空断点
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.10" data-path="10-step.html">
            
                <a href="10-step.html">
            
                    
                    6.10 步进操作
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.11" data-path="11-continue.html">
            
                <a href="11-continue.html">
            
                    
                    6.11 运行到断点
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.12" data-path="12-pmem.html">
            
                <a href="12-pmem.html">
            
                    
                    6.12 打印内存数据
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.13" data-path="13-pregs.html">
            
                <a href="13-pregs.html">
            
                    
                    6.13 打印寄存器数据
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.14" data-path="14-set-mem.html">
            
                <a href="14-set-mem.html">
            
                    
                    6.14 修改内存数据
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.15" data-path="15-set-regs.html">
            
                <a href="15-set-regs.html">
            
                    
                    6.15 修改寄存器数据
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.16" data-path="20-trace_new_threads.html">
            
                <a href="20-trace_new_threads.html">
            
                    
                    6.20 跟踪多线程程序1
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.17" data-path="21-trace_old_threads.html">
            
                <a href="21-trace_old_threads.html">
            
                    
                    6.21 跟踪多线程程序2
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.18" data-path="80-aslr.html">
            
                <a href="80-aslr.html">
            
                    
                    6.80 认识ASLR
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.19" data-path="99-more.html">
            
                <a href="99-more.html">
            
                    
                    6.99 More...
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../7-headto-sym-debugger/">
            
                <a href="../7-headto-sym-debugger/">
            
                    
                    7 挺进符号级调试器
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="../7-headto-sym-debugger/1-how-go-build-works.html">
            
                <a href="../7-headto-sym-debugger/1-how-go-build-works.html">
            
                    
                    7.1 Go构建内幕
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="../7-headto-sym-debugger/2-elf.html">
            
                <a href="../7-headto-sym-debugger/2-elf.html">
            
                    
                    7.2 理解ELF文件
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.3" data-path="../7-headto-sym-debugger/3-syms.html">
            
                <a href="../7-headto-sym-debugger/3-syms.html">
            
                    
                    7.3 符号&符号表
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.4" data-path="../7-headto-sym-debugger/4-syms-resolve-reloc.html">
            
                <a href="../7-headto-sym-debugger/4-syms-resolve-reloc.html">
            
                    
                    7.4 符号解析&重定位
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.5" data-path="../7-headto-sym-debugger/5-loading.html">
            
                <a href="../7-headto-sym-debugger/5-loading.html">
            
                    
                    7.5 加载
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.6" data-path="../7-headto-sym-debugger/6-gopkg-debug/">
            
                <a href="../7-headto-sym-debugger/6-gopkg-debug/">
            
                    
                    7.6 go标准库debug/*
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.6.1" data-path="../7-headto-sym-debugger/6-gopkg-debug/1-elf.html">
            
                <a href="../7-headto-sym-debugger/6-gopkg-debug/1-elf.html">
            
                    
                    7.6.1 debug/elf
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.6.2" data-path="../7-headto-sym-debugger/6-gopkg-debug/2-gosym.html">
            
                <a href="../7-headto-sym-debugger/6-gopkg-debug/2-gosym.html">
            
                    
                    7.6.2 debug/gosym
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.6.3" data-path="../7-headto-sym-debugger/6-gopkg-debug/3-dwarf.html">
            
                <a href="../7-headto-sym-debugger/6-gopkg-debug/3-dwarf.html">
            
                    
                    7.6.3 debug/dwarf
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7.7" data-path="../7-headto-sym-debugger/7-headto-dwarf/">
            
                <a href="../7-headto-sym-debugger/7-headto-dwarf/">
            
                    
                    7.7 挺进DWARF
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.7.1" data-path="../7-headto-sym-debugger/7-headto-dwarf/1-gopkgs-about-dwarf.html">
            
                <a href="../7-headto-sym-debugger/7-headto-dwarf/1-gopkgs-about-dwarf.html">
            
                    
                    7.7.1 相关的GoPackages
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.7.2" data-path="../7-headto-sym-debugger/7-headto-dwarf/2-delve-into-internals.html">
            
                <a href="../7-headto-sym-debugger/7-headto-dwarf/2-delve-into-internals.html">
            
                    
                    7.7.2 如何破解那些细节
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.7.3" data-path="../7-headto-sym-debugger/7-headto-dwarf/3-compiler-gen-dwarfdata.html">
            
                <a href="../7-headto-sym-debugger/7-headto-dwarf/3-compiler-gen-dwarfdata.html">
            
                    
                    7.7.3 编译器生成DWARF数据
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.7.4" data-path="../7-headto-sym-debugger/7-headto-dwarf/4-linker-gen-dwarfdata.html">
            
                <a href="../7-headto-sym-debugger/7-headto-dwarf/4-linker-gen-dwarfdata.html">
            
                    
                    7.7.4 链接器生成DWARF数据
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.7.5" data-path="../7-headto-sym-debugger/7-headto-dwarf/5-headto-dwarf.html">
            
                <a href="../7-headto-sym-debugger/7-headto-dwarf/5-headto-dwarf.html">
            
                    
                    7.7.5 可以了解DWARF了
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../8-dwarf/">
            
                <a href="../8-dwarf/">
            
                    
                    8 调试信息标准: DWARF
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="../8-dwarf/1-history.html">
            
                <a href="../8-dwarf/1-history.html">
            
                    
                    8.1 DWARF发展历史
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2" data-path="../8-dwarf/2-overview.html">
            
                <a href="../8-dwarf/2-overview.html">
            
                    
                    8.2 DWARF内容概览
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3" data-path="../8-dwarf/3-dwarfdata.html">
            
                <a href="../8-dwarf/3-dwarfdata.html">
            
                    
                    8.3 DWARF数据分类
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.4" data-path="../8-dwarf/4-die/">
            
                <a href="../8-dwarf/4-die/">
            
                    
                    8.4 DIE详细介绍
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.4.1" data-path="../8-dwarf/4-die/1-desc-data-type.html">
            
                <a href="../8-dwarf/4-die/1-desc-data-type.html">
            
                    
                    8.4.1 DIE描述数据和类型
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.4.2" data-path="../8-dwarf/4-die/2-desc-locations.html">
            
                <a href="../8-dwarf/4-die/2-desc-locations.html">
            
                    
                    8.4.2 位置数据
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.4.3" data-path="../8-dwarf/4-die/3-desc-code.html">
            
                <a href="../8-dwarf/4-die/3-desc-code.html">
            
                    
                    8.4.3 DIE描述可执行代码
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.4.4" data-path="../8-dwarf/4-die/4-encoding.html">
            
                <a href="../8-dwarf/4-die/4-encoding.html">
            
                    
                    8.4.4 DIE数据编码
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8.5" data-path="../8-dwarf/5-other/">
            
                <a href="../8-dwarf/5-other/">
            
                    
                    8.5 其他调试数据
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.5.1" data-path="../8-dwarf/5-other/1-accelerated-access.html">
            
                <a href="../8-dwarf/5-other/1-accelerated-access.html">
            
                    
                    8.5.1 加速访问
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.5.2" data-path="../8-dwarf/5-other/2-lineno-table.html">
            
                <a href="../8-dwarf/5-other/2-lineno-table.html">
            
                    
                    8.5.2 行号表信息
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.5.3" data-path="../8-dwarf/5-other/3-callframe-info.html">
            
                <a href="../8-dwarf/5-other/3-callframe-info.html">
            
                    
                    8.5.3 调用栈帧信息
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.5.4" data-path="../8-dwarf/5-other/4-macro-info.html">
            
                <a href="../8-dwarf/5-other/4-macro-info.html">
            
                    
                    8.5.4 宏信息
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.5.5" data-path="../8-dwarf/5-other/5-varlen-data.html">
            
                <a href="../8-dwarf/5-other/5-varlen-data.html">
            
                    
                    8.5.5 变长数据
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.5.6" data-path="../8-dwarf/5-other/6-shrink-data.html">
            
                <a href="../8-dwarf/5-other/6-shrink-data.html">
            
                    
                    8.5.6 压缩DWARF数据
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.5.7" data-path="../8-dwarf/5-other/7-elf-sections.html">
            
                <a href="../8-dwarf/5-other/7-elf-sections.html">
            
                    
                    8.5.7 ELF Sections
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8.6" data-path="../8-dwarf/6-practices.html">
            
                <a href="../8-dwarf/6-practices.html">
            
                    
                    8.6 DWARF解析及应用
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.7" data-path="../8-dwarf/7-summary.html">
            
                <a href="../8-dwarf/7-summary.html">
            
                    
                    8.7 本章总结
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../9-develop-sym-debugger/">
            
                <a href="../9-develop-sym-debugger/">
            
                    
                    9 开发go符号级调试器
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" data-path="../9-develop-sym-debugger/1-架构设计/">
            
                <a href="../9-develop-sym-debugger/1-架构设计/">
            
                    
                    9.1 架构设计
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1.1" data-path="../9-develop-sym-debugger/1-架构设计/1-现代调试器架构.html">
            
                <a href="../9-develop-sym-debugger/1-架构设计/1-现代调试器架构.html">
            
                    
                    9.1.1 现代调试器架构
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.1.2" data-path="../9-develop-sym-debugger/1-架构设计/2-前端UI层设计.html">
            
                <a href="../9-develop-sym-debugger/1-架构设计/2-前端UI层设计.html">
            
                    
                    9.1.2 前端UI层设计
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.1.3" data-path="../9-develop-sym-debugger/1-架构设计/3-Service层设计.html">
            
                <a href="../9-develop-sym-debugger/1-架构设计/3-Service层设计.html">
            
                    
                    9.1.3 Service层设计
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.1.4" data-path="../9-develop-sym-debugger/1-架构设计/4-后端符号层设计.html">
            
                <a href="../9-develop-sym-debugger/1-架构设计/4-后端符号层设计.html">
            
                    
                    9.1.4 后端符号层设计
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.1.5" data-path="../9-develop-sym-debugger/1-架构设计/5-后端目标层设计.html">
            
                <a href="../9-develop-sym-debugger/1-架构设计/5-后端目标层设计.html">
            
                    
                    9.1.5 后端目标层设计
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.1.6" data-path="../9-develop-sym-debugger/1-架构设计/6-日志系统设计.html">
            
                <a href="../9-develop-sym-debugger/1-架构设计/6-日志系统设计.html">
            
                    
                    9.1.6 日志系统设计
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9.2" data-path="../9-develop-sym-debugger/2-核心调试逻辑/">
            
                <a href="../9-develop-sym-debugger/2-核心调试逻辑/">
            
                    
                    9.2 核心调试逻辑
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.2.1" data-path="../9-develop-sym-debugger/2-核心调试逻辑/00-cmds.html">
            
                <a href="../9-develop-sym-debugger/2-核心调试逻辑/00-cmds.html">
            
                    
                    9.2.00 核心调试命令
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2.2" data-path="../9-develop-sym-debugger/2-核心调试逻辑/01-debug-session.html">
            
                <a href="../9-develop-sym-debugger/2-核心调试逻辑/01-debug-session.html">
            
                    
                    9.2.01 打开调试会话
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2.3" data-path="../9-develop-sym-debugger/2-核心调试逻辑/11-tinydbg_attach.html">
            
                <a href="../9-develop-sym-debugger/2-核心调试逻辑/11-tinydbg_attach.html">
            
                    
                    9.2.11 tinydbg attach
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2.4" data-path="../9-develop-sym-debugger/2-核心调试逻辑/12-tinydbg_attach_waitfor.html">
            
                <a href="../9-develop-sym-debugger/2-核心调试逻辑/12-tinydbg_attach_waitfor.html">
            
                    
                    9.2.12 tinydbg attach+waitfor
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2.5" data-path="../9-develop-sym-debugger/2-核心调试逻辑/13-tinydbg_exec.html">
            
                <a href="../9-develop-sym-debugger/2-核心调试逻辑/13-tinydbg_exec.html">
            
                    
                    9.2.13 tinydbg exec
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2.6" data-path="../9-develop-sym-debugger/2-核心调试逻辑/14-tinydbg_debug.html">
            
                <a href="../9-develop-sym-debugger/2-核心调试逻辑/14-tinydbg_debug.html">
            
                    
                    9.2.14 tinydbg debug
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2.7" data-path="../9-develop-sym-debugger/2-核心调试逻辑/15-tinydbg_core1.html">
            
                <a href="../9-develop-sym-debugger/2-核心调试逻辑/15-tinydbg_core1.html">
            
                    
                    9.2.15 tinydbg core - part1
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2.8" data-path="../9-develop-sym-debugger/2-核心调试逻辑/15-tinydbg_core2.html">
            
                <a href="../9-develop-sym-debugger/2-核心调试逻辑/15-tinydbg_core2.html">
            
                    
                    9.2.15 tinydbg core - part2
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2.9" data-path="../9-develop-sym-debugger/2-核心调试逻辑/16-tinydbg_connect.html">
            
                <a href="../9-develop-sym-debugger/2-核心调试逻辑/16-tinydbg_connect.html">
            
                    
                    9.2.16 tinydbg connect
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2.10" data-path="../9-develop-sym-debugger/2-核心调试逻辑/17-tinydbg_trace.html">
            
                <a href="../9-develop-sym-debugger/2-核心调试逻辑/17-tinydbg_trace.html">
            
                    
                    9.2.17 tinydbg trace
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2.11" data-path="../9-develop-sym-debugger/2-核心调试逻辑/19-how_evalexpr_works.html">
            
                <a href="../9-develop-sym-debugger/2-核心调试逻辑/19-how_evalexpr_works.html">
            
                    
                    9.2.19 evalexpr表达式计算引擎
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2.12" data-path="../9-develop-sym-debugger/2-核心调试逻辑/20-how_locspec_works.html">
            
                <a href="../9-develop-sym-debugger/2-核心调试逻辑/20-how_locspec_works.html">
            
                    
                    9.2.20 locspec解析与地址转换
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2.13" data-path="../9-develop-sym-debugger/2-核心调试逻辑/21-debug_disassemble.html">
            
                <a href="../9-develop-sym-debugger/2-核心调试逻辑/21-debug_disassemble.html">
            
                    
                    9.2.21 tinydbg> disass
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2.14" data-path="../9-develop-sym-debugger/2-核心调试逻辑/22-debug_breakpoint_part1.html">
            
                <a href="../9-develop-sym-debugger/2-核心调试逻辑/22-debug_breakpoint_part1.html">
            
                    
                    9.2.22 tinydbg> breakpoint - part1: 断点精细化管理
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2.15" data-path="../9-develop-sym-debugger/2-核心调试逻辑/23-debug_breakpoint_part2.html">
            
                <a href="../9-develop-sym-debugger/2-核心调试逻辑/23-debug_breakpoint_part2.html">
            
                    
                    9.2.23 tinydbg> breakpoint - part2: 添加断点+执行到断点
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2.16" data-path="../9-develop-sym-debugger/2-核心调试逻辑/24-debug_breakpoint_part3.html">
            
                <a href="../9-develop-sym-debugger/2-核心调试逻辑/24-debug_breakpoint_part3.html">
            
                    
                    9.2.24 tinydbg> breakpoint - part3: 条件断点+执行到断点
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2.17" data-path="../9-develop-sym-debugger/2-核心调试逻辑/25-debug_breakpoint_part4.html">
            
                <a href="../9-develop-sym-debugger/2-核心调试逻辑/25-debug_breakpoint_part4.html">
            
                    
                    9.2.25 tinydbg> breakpoint - part4: 其他断点相关命令
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2.18" data-path="../9-develop-sym-debugger/2-核心调试逻辑/26-debug_trace.html">
            
                <a href="../9-develop-sym-debugger/2-核心调试逻辑/26-debug_trace.html">
            
                    
                    9.2.26 tinydbg> trace
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2.19" data-path="../9-develop-sym-debugger/2-核心调试逻辑/27-debug_watch.html">
            
                <a href="../9-develop-sym-debugger/2-核心调试逻辑/27-debug_watch.html">
            
                    
                    9.2.27 tinydbg> watch
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2.20" data-path="../9-develop-sym-debugger/2-核心调试逻辑/28-debug_continue.html">
            
                <a href="../9-develop-sym-debugger/2-核心调试逻辑/28-debug_continue.html">
            
                    
                    9.2.28 tinydbg> continue
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2.21" data-path="../9-develop-sym-debugger/2-核心调试逻辑/29-debug_next.html">
            
                <a href="../9-develop-sym-debugger/2-核心调试逻辑/29-debug_next.html">
            
                    
                    9.2.29 tinydbg> next
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2.22" data-path="../9-develop-sym-debugger/2-核心调试逻辑/30-debug_step.html">
            
                <a href="../9-develop-sym-debugger/2-核心调试逻辑/30-debug_step.html">
            
                    
                    9.2.30 tinydbg> step
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2.23" data-path="../9-develop-sym-debugger/2-核心调试逻辑/31-debug_pmem.html">
            
                <a href="../9-develop-sym-debugger/2-核心调试逻辑/31-debug_pmem.html">
            
                    
                    9.2.31 tinydbg> pmem
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2.24" data-path="../9-develop-sym-debugger/2-核心调试逻辑/32-debug_regs.html">
            
                <a href="../9-develop-sym-debugger/2-核心调试逻辑/32-debug_regs.html">
            
                    
                    9.2.32 tinydbg> regs
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2.25" data-path="../9-develop-sym-debugger/2-核心调试逻辑/33-debug_funcs.html">
            
                <a href="../9-develop-sym-debugger/2-核心调试逻辑/33-debug_funcs.html">
            
                    
                    9.2.33 tinydbg> funcs
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2.26" data-path="../9-develop-sym-debugger/2-核心调试逻辑/34-debug_vars.html">
            
                <a href="../9-develop-sym-debugger/2-核心调试逻辑/34-debug_vars.html">
            
                    
                    9.2.34 tinydbg> vars
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2.27" data-path="../9-develop-sym-debugger/2-核心调试逻辑/35-debug_bt.html">
            
                <a href="../9-develop-sym-debugger/2-核心调试逻辑/35-debug_bt.html">
            
                    
                    9.2.35 tinydbg> bt
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2.28" data-path="../9-develop-sym-debugger/2-核心调试逻辑/100-how_listfunctions_work.html">
            
                <a href="../9-develop-sym-debugger/2-核心调试逻辑/100-how_listfunctions_work.html">
            
                    
                    9.2.100 how ListFunctions work
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2.29" data-path="../9-develop-sym-debugger/2-核心调试逻辑/100-debug_goroutines.html">
            
                <a href="../9-develop-sym-debugger/2-核心调试逻辑/100-debug_goroutines.html">
            
                    
                    9.2.100 tinydbg> goroutines
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2.30" data-path="../9-develop-sym-debugger/2-核心调试逻辑/100-multi-threads.html">
            
                <a href="../9-develop-sym-debugger/2-核心调试逻辑/100-multi-threads.html">
            
                    
                    9.2.100 跟踪多线程程序
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9.3" data-path="../9-develop-sym-debugger/3-高级功能扩展/">
            
                <a href="../9-develop-sym-debugger/3-高级功能扩展/">
            
                    
                    9.3 高级功能扩展
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.3.1" data-path="../9-develop-sym-debugger/3-高级功能扩展/100-howto_integrate_starlark.html">
            
                <a href="../9-develop-sym-debugger/3-高级功能扩展/100-howto_integrate_starlark.html">
            
                    
                    9.3.100 集成starlark
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.3.2" data-path="../9-develop-sym-debugger/3-高级功能扩展/101-howto_tracing_via_ebpf.html">
            
                <a href="../9-develop-sym-debugger/3-高级功能扩展/101-howto_tracing_via_ebpf.html">
            
                    
                    9.3.101 基于eBPF跟踪
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.3.3" data-path="../9-develop-sym-debugger/3-高级功能扩展/102-howto_syntax_highlight.html">
            
                <a href="../9-develop-sym-debugger/3-高级功能扩展/102-howto_syntax_highlight.html">
            
                    
                    9.3.102 实现语法高亮
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.3.4" data-path="../9-develop-sym-debugger/3-高级功能扩展/103-howto_paging_output.html">
            
                <a href="../9-develop-sym-debugger/3-高级功能扩展/103-howto_paging_output.html">
            
                    
                    9.3.103 实现分页输出
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.3.5" data-path="../9-develop-sym-debugger/3-高级功能扩展/104-howto_read_separate_dwarfdata.html">
            
                <a href="../9-develop-sym-debugger/3-高级功能扩展/104-howto_read_separate_dwarfdata.html">
            
                    
                    9.3.104 读取分离存储的DWARF数据
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.3.6" data-path="../9-develop-sym-debugger/3-高级功能扩展/105-howto_guess_substitutepath.html">
            
                <a href="../9-develop-sym-debugger/3-高级功能扩展/105-howto_guess_substitutepath.html">
            
                    
                    9.3.105 自动推测源文件路径映射
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.3.7" data-path="../9-develop-sym-debugger/3-高级功能扩展/106-howto_redirect_target_io.html">
            
                <a href="../9-develop-sym-debugger/3-高级功能扩展/106-howto_redirect_target_io.html">
            
                    
                    9.3.106 实现目标进程IO重定向
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.3.8" data-path="../9-develop-sym-debugger/3-高级功能扩展/107-howto_customize_tinydbg.html">
            
                <a href="../9-develop-sym-debugger/3-高级功能扩展/107-howto_customize_tinydbg.html">
            
                    
                    9.3.107 支持用户偏好配置
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.3.9" data-path="../9-develop-sym-debugger/3-高级功能扩展/108-howto_accept_multiclient.html">
            
                <a href="../9-develop-sym-debugger/3-高级功能扩展/108-howto_accept_multiclient.html">
            
                    
                    9.3.108 支持多客户端调试模式
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.3.10" data-path="../9-develop-sym-debugger/3-高级功能扩展/109-howto_transcript_debugging.html">
            
                <a href="../9-develop-sym-debugger/3-高级功能扩展/109-howto_transcript_debugging.html">
            
                    
                    9.3.109 支持调试活动记录本
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="../10-extras/">
            
                <a href="../10-extras/">
            
                    
                    10 主流调试技术解析
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.1" data-path="../10-extras/1-development-of-debugger.html">
            
                <a href="../10-extras/1-development-of-debugger.html">
            
                    
                    10.1 调试器发展历程
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.2" data-path="../10-extras/2-development-of-logging.html">
            
                <a href="../10-extras/2-development-of-logging.html">
            
                    
                    10.2 日志系统展历程
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.3" data-path="../10-extras/3-development-of-metrics.html">
            
                <a href="../10-extras/3-development-of-metrics.html">
            
                    
                    10.3 指标系统发展历程
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.4" data-path="../10-extras/4-development-of-tracing.html">
            
                <a href="../10-extras/4-development-of-tracing.html">
            
                    
                    10.4 跟踪系统发展历程
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.5" data-path="../10-extras/5-development-of-bisect.html">
            
                <a href="../10-extras/5-development-of-bisect.html">
            
                    
                    10.5 Bisect发展历程
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.6" data-path="../10-extras/6-development-of-ebpf.html">
            
                <a href="../10-extras/6-development-of-ebpf.html">
            
                    
                    10.6 eBPF发展历程
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.7" data-path="../10-extras/7-development-of-replay.html">
            
                <a href="../10-extras/7-development-of-replay.html">
            
                    
                    10.7 录制重放发展历程
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.8" data-path="../10-extras/8-development-of-debug-dsys.html">
            
                <a href="../10-extras/8-development-of-debug-dsys.html">
            
                    
                    10.8 分布式调试发展历程
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="../11-thanks/">
            
                <a href="../11-thanks/">
            
                    
                    11 致谢
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="../12-appendix/">
            
                <a href="../12-appendix/">
            
                    
                    12 附录
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.1" data-path="../12-appendix/1-go-programme-start.html">
            
                <a href="../12-appendix/1-go-programme-start.html">
            
                    
                    12.1 go程序启动流程
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.2" data-path="../12-appendix/2-auto-trace-cloned-threads.html">
            
                <a href="../12-appendix/2-auto-trace-cloned-threads.html">
            
                    
                    12.2 自动跟踪新线程
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.3" data-path="../12-appendix/3-git-bisect.html">
            
                <a href="../12-appendix/3-git-bisect.html">
            
                    
                    12.3 git bisect
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.4" data-path="../12-appendix/80-go-tool-compile.html">
            
                <a href="../12-appendix/80-go-tool-compile.html">
            
                    
                    12.10 编译工具链/compile
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5" data-path="../12-appendix/81-go-tool-asm.html">
            
                <a href="../12-appendix/81-go-tool-asm.html">
            
                    
                    12.11 编译工具链/asm
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.6" data-path="../12-appendix/82-go-tool-link.html">
            
                <a href="../12-appendix/82-go-tool-link.html">
            
                    
                    12.12 编译工具链/link
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.7" data-path="../12-appendix/90-why-buildid-loaded.html">
            
                <a href="../12-appendix/90-why-buildid-loaded.html">
            
                    
                    12.13 More: GNU build-id+gobuildid
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.8" data-path="../12-appendix/91-syntax-and-semantic-analysis.html">
            
                <a href="../12-appendix/91-syntax-and-semantic-analysis.html">
            
                    
                    12.14 More: 语法分析vs语义分析区别
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.9" data-path="../12-appendix/92-why-gdb-uses-symtab.html">
            
                <a href="../12-appendix/92-why-gdb-uses-symtab.html">
            
                    
                    12.15 More: 为什么GDB使用符号表+DWARF
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >6.2 进程attach</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <p><style>
body {
  counter-reset: h1 13;
}
</style></p>
<h2 id="attach&#x8FDB;&#x7A0B;">Attach&#x8FDB;&#x7A0B;</h2>
<h3 id="&#x5B9E;&#x73B0;&#x76EE;&#x6807;&#xFF1A;godbg-attach--p-pid">&#x5B9E;&#x73B0;&#x76EE;&#x6807;&#xFF1A;<code>godbg attach -p &lt;pid&gt;</code></h3>
<p>&#x5982;&#x679C;&#x8FDB;&#x7A0B;&#x5DF2;&#x7ECF;&#x5728;&#x8FD0;&#x884C;&#x4E86;&#xFF0C;&#x5982;&#x679C;&#x8981;&#x5BF9;&#x5176;&#x8FDB;&#x884C;&#x8C03;&#x8BD5;&#x9700;&#x8981;&#x5C06;&#x8FDB;&#x7A0B;&#x6302;&#x4F4F;(attach)&#xFF0C;&#x8BA9;&#x5176;&#x505C;&#x4E0B;&#x6765;&#x7B49;&#x5F85;&#x8C03;&#x8BD5;&#x5668;&#x5BF9;&#x5176;&#x8FDB;&#x884C;&#x63A7;&#x5236;&#x3002;</p>
<p>&#x5E38;&#x89C1;&#x7684;&#x8C03;&#x8BD5;&#x5668;&#x5982;dlv&#x3001;gdb&#x7B49;&#x90FD;&#x652F;&#x6301;&#x901A;&#x8FC7;&#x53C2;&#x6570; <code>-p pid</code> &#x7684;&#x5F62;&#x5F0F;&#x6765;&#x4F20;&#x9012;&#x76EE;&#x6807;&#x8FDB;&#x7A0B;&#x53F7;&#x6765;&#x5BF9;&#x8FD0;&#x884C;&#x4E2D;&#x7684;&#x8FDB;&#x7A0B;&#x8FDB;&#x884C;&#x8C03;&#x8BD5;&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x5C06;&#x5B9E;&#x73B0;&#x7A0B;&#x5E8F;godbg&#xFF0C;&#x5B83;&#x652F;&#x6301;&#x5B50;&#x547D;&#x4EE4; <code>attach -p &lt;pid&gt;</code>&#xFF0C;&#x5982;&#x679C;&#x76EE;&#x6807;&#x8FDB;&#x7A0B;&#x5B58;&#x5728;&#xFF0C;godbg&#x5C06;attach&#x5230;&#x76EE;&#x6807;&#x8FDB;&#x7A0B;&#xFF0C;&#x6B64;&#x65F6;&#x76EE;&#x6807;&#x8FDB;&#x7A0B;&#x4F1A;&#x6682;&#x505C;&#x6267;&#x884C;&#x3002;&#x7136;&#x540E;&#x6211;&#x4EEC;&#x8BA9;godbg&#x4F11;&#x7720;&#x51E0;&#x79D2;&#x949F;&#xFF0C;&#x518D;detach&#x76EE;&#x6807;&#x8FDB;&#x7A0B;&#xFF0C;&#x76EE;&#x6807;&#x8FDB;&#x7A0B;&#x4F1A;&#x6062;&#x590D;&#x6267;&#x884C;&#x3002;</p>
<blockquote>
<p>ps: &#x8FD9;&#x91CC;&#x4F11;&#x7720;&#x7684;&#x51E0;&#x79D2;&#x949F;&#xFF0C;&#x7528;&#x6237;&#x53EF;&#x4EE5;&#x5148;&#x5C06;&#x5176;&#x5047;&#x60F3;&#x6210;&#x4E00;&#x7CFB;&#x5217;&#x7684;&#x8C03;&#x8BD5;&#x64CD;&#x4F5C;&#xFF0C;&#x5982;&#x8BBE;&#x7F6E;&#x65AD;&#x70B9;&#x3001;&#x68C0;&#x67E5;&#x8FDB;&#x7A0B;&#x5BC4;&#x5B58;&#x5668;&#x3001;&#x68C0;&#x67E5;&#x5185;&#x5B58;&#x7B49;&#x7B49;&#xFF0C;&#x540E;&#x9762;&#x5C0F;&#x8282;&#x4E2D;&#x6211;&#x4EEC;&#x5C06;&#x652F;&#x6301;&#x8FD9;&#x4E9B;&#x80FD;&#x529B;&#x3002;</p>
</blockquote>
<h3 id="&#x57FA;&#x7840;&#x77E5;&#x8BC6;">&#x57FA;&#x7840;&#x77E5;&#x8BC6;</h3>
<h4 id="tracee">tracee</h4>
<p>&#x9996;&#x5148;&#x8981;&#x8FDB;&#x4E00;&#x6B65;&#x660E;&#x786E;tracee&#x7684;&#x6982;&#x5FF5;&#xFF0C;&#x867D;&#x7136;&#x6211;&#x4EEC;&#x770B;&#x4E0A;&#x53BB;&#x662F;&#x5BF9;&#x8FDB;&#x7A0B;&#x8FDB;&#x884C;&#x8C03;&#x8BD5;&#xFF0C;&#x5B9E;&#x9645;&#x4E0A;&#x8C03;&#x8BD5;&#x5668;&#x5185;&#x90E8;&#x5DE5;&#x4F5C;&#x65F6;&#xFF0C;&#x662F;&#x5BF9;&#x4E00;&#x4E2A;&#x4E00;&#x4E2A;&#x7684;&#x7EBF;&#x7A0B;&#x8FDB;&#x884C;&#x8C03;&#x8BD5;&#x3002;</p>
<p>tracee&#xFF0C;&#x6307;&#x7684;&#x662F;&#x88AB;&#x8C03;&#x8BD5;&#x7684;&#x7EBF;&#x7A0B;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x8FDB;&#x7A0B;&#x3002;&#x5BF9;&#x4E8E;&#x4E00;&#x4E2A;&#x591A;&#x7EBF;&#x7A0B;&#x7A0B;&#x5E8F;&#x800C;&#x8A00;&#xFF0C;&#x53EF;&#x80FD;&#x8981;&#x8DDF;&#x8E2A;&#xFF08;trace&#xFF09;&#x90E8;&#x5206;&#x6216;&#x8005;&#x5168;&#x90E8;&#x7684;&#x7EBF;&#x7A0B;&#x4EE5;&#x65B9;&#x4FBF;&#x8C03;&#x8BD5;&#xFF0C;&#x6CA1;&#x6709;&#x88AB;&#x8DDF;&#x8E2A;&#x7684;&#x7EBF;&#x7A0B;&#x5C06;&#x4F1A;&#x7EE7;&#x7EED;&#x6267;&#x884C;&#xFF0C;&#x800C;&#x88AB;&#x8DDF;&#x8E2A;&#x7684;&#x7EBF;&#x7A0B;&#x5219;&#x53D7;&#x8C03;&#x8BD5;&#x5668;&#x63A7;&#x5236;&#x3002;&#x751A;&#x81F3;&#x540C;&#x4E00;&#x4E2A;&#x88AB;&#x8C03;&#x8BD5;&#x8FDB;&#x7A0B;&#x4E2D;&#x7684;&#x4E0D;&#x540C;&#x7EBF;&#x7A0B;&#xFF0C;&#x53EF;&#x4EE5;&#x7531;&#x4E0D;&#x540C;&#x7684;tracer&#x6765;&#x63A7;&#x5236;&#x3002;</p>
<h4 id="tracer">tracer</h4>
<p>tracer&#xFF0C;&#x6307;&#x7684;&#x662F;&#x5411;tracee&#x53D1;&#x9001;&#x8C03;&#x8BD5;&#x63A7;&#x5236;&#x547D;&#x4EE4;&#x7684;&#x8C03;&#x8BD5;&#x5668;&#x8FDB;&#x7A0B;&#xFF0C;&#x51C6;&#x786E;&#x5730;&#x8BF4;&#xFF0C;&#x4E5F;&#x662F;&#x7EBF;&#x7A0B;&#x3002;</p>
<p>&#x4E00;&#x65E6;tracer&#x548C;tracee&#x5EFA;&#x7ACB;&#x4E86;&#x8054;&#x7CFB;&#x4E4B;&#x540E;&#xFF0C;tracer&#x5C31;&#x53EF;&#x4EE5;&#x7ED9;tracee&#x53D1;&#x9001;&#x5404;&#x79CD;&#x8C03;&#x8BD5;&#x547D;&#x4EE4;&#x3002;</p>
<h4 id="ptrace">ptrace</h4>
<p>&#x6211;&#x4EEC;&#x7684;&#x8C03;&#x8BD5;&#x5668;&#x793A;&#x4F8B;&#x662F;&#x57FA;&#x4E8E;Linux&#x5E73;&#x53F0;&#x7F16;&#x5199;&#x7684;&#xFF0C;&#x8C03;&#x8BD5;&#x80FD;&#x529B;&#x4F9D;&#x8D56;&#x4E8E;Linux ptrace&#x3002;</p>
<p>&#x901A;&#x5E38;&#xFF0C;&#x5982;&#x679C;&#x8C03;&#x8BD5;&#x5668;&#x4E5F;&#x662F;&#x591A;&#x7EBF;&#x7A0B;&#x7A0B;&#x5E8F;&#xFF0C;&#x5C31;&#x8981;&#x6CE8;&#x610F;ptrace&#x7684;&#x7EA6;&#x675F;&#xFF0C;&#x5F53;tracer&#x3001;tracee&#x5EFA;&#x7ACB;&#x4E86;&#x8DDF;&#x8E2A;&#x5173;&#x7CFB;&#x540E;&#xFF0C;tracee&#xFF08;&#x88AB;&#x8DDF;&#x8E2A;&#x7EBF;&#x7A0B;&#xFF09;&#x540E;&#x7EED;&#x63A5;&#x6536;&#x5230;&#x7684;&#x591A;&#x4E2A;&#x8C03;&#x8BD5;&#x547D;&#x4EE4;&#x5E94;&#x8BE5;&#x6765;&#x81EA;&#x540C;&#x4E00;&#x4E2A;tracer&#xFF08;&#x8DDF;&#x8E2A;&#x7EBF;&#x7A0B;&#xFF09;&#xFF0C;&#x610F;&#x5473;&#x7740;&#x8C03;&#x8BD5;&#x5668;&#x5B9E;&#x73B0;&#x65F6;&#x8981;&#x5C06;&#x53D1;&#x9001;&#x8C03;&#x8BD5;&#x547D;&#x4EE4;&#x7ED9;tracee&#x7684;task&#x7ED1;&#x5B9A;&#x5230;&#x7279;&#x5B9A;&#x7EBF;&#x7A0B;&#x4E0A;&#x3002;&#x66F4;&#x5177;&#x4F53;&#x5730;&#x8BB2;&#xFF0C;&#x8FD9;&#x91CC;&#x7684;task&#x53EF;&#x4EE5;&#x662F;goroutine&#x3002;</p>
<p>&#x6240;&#x4EE5;&#xFF0C;&#x5728;&#x6211;&#x4EEC;&#x53C2;&#x8003;dlv&#x7B49;&#x8C03;&#x8BD5;&#x5668;&#x7684;&#x5B9E;&#x73B0;&#x65F6;&#x4F1A;&#x53D1;&#x73B0;&#xFF0C;&#x53D1;&#x9001;&#x8C03;&#x8BD5;&#x547D;&#x4EE4;&#x7684;goroutine&#x901A;&#x5E38;&#x4F1A;&#x8C03;&#x7528; <code>runtime.LockOSThread()</code>&#x6765;&#x7ED1;&#x5B9A;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#xFF0C;&#x4E13;&#x95E8;&#x7528;&#x6765;&#x5411;attached tracee&#x53D1;&#x9001;&#x8C03;&#x8BD5;&#x6307;&#x4EE4;&#xFF08;&#x4E5F;&#x5C31;&#x662F;&#x5404;&#x79CD;ptrace&#x64CD;&#x4F5C;&#xFF09;&#x3002;</p>
<blockquote>
<p>runtime.LockOSThread()&#xFF0C;&#x8BE5;&#x51FD;&#x6570;&#x7684;&#x4F5C;&#x7528;&#x662F;&#x5C06;&#x8C03;&#x7528;&#x8BE5;&#x51FD;&#x6570;&#x7684;goroutine&#x7ED1;&#x5B9A;&#x5230;&#x8BE5;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x7EBF;&#x7A0B;&#x4E0A;&#xFF0C;&#x610F;&#x5473;&#x7740;&#x8BE5;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x7EBF;&#x7A0B;&#x53EA;&#x4F1A;&#x7528;&#x6765;&#x6267;&#x884C;&#x8BE5;goroutine&#x4E0A;&#x7684;&#x64CD;&#x4F5C;&#xFF0C;&#x9664;&#x975E;&#x8BE5;goroutine&#x8C03;&#x7528;&#x4E86;runtime.UnLockOSThread()&#x89E3;&#x9664;&#x8FD9;&#x79CD;&#x7ED1;&#x5B9A;&#x5173;&#x7CFB;&#xFF0C;&#x5426;&#x5219;&#x8BE5;&#x7EBF;&#x7A0B;&#x4E0D;&#x4F1A;&#x7528;&#x6765;&#x8C03;&#x5EA6;&#x5176;&#x4ED6;goroutine&#x3002;&#x8C03;&#x7528;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x7684;goroutine&#x4E5F;&#x53EA;&#x80FD;&#x5728;&#x5F53;&#x524D;&#x7EBF;&#x7A0B;&#x4E0A;&#x6267;&#x884C;&#xFF0C;&#x4E0D;&#x4F1A;&#x88AB;&#x8C03;&#x5EA6;&#x5668;&#x8FC1;&#x79FB;&#x5230;&#x5176;&#x4ED6;&#x7EBF;&#x7A0B;&#x3002;see:</p>
<pre><code>package runtime // import &quot;runtime&quot;

func LockOSThread()
    LockOSThread wires the calling goroutine to its current operating system
    thread. The calling goroutine will always execute in that thread, and no
    other goroutine will execute in it, until the calling goroutine has made as
    many calls to UnlockOSThread as to LockOSThread. If the calling goroutine
    exits without unlocking the thread, the thread will be terminated.

    All init functions are run on the startup thread. Calling LockOSThread from
    an init function will cause the main function to be invoked on that thread.

    A goroutine should call LockOSThread before calling OS services or non-Go
    library functions that depend on per-thread state.
</code></pre><p>&#x8C03;&#x7528;&#x4E86;&#x8BE5;&#x51FD;&#x6570;&#x4E4B;&#x540E;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x6EE1;&#x8DB3;tracee&#x5BF9;tracer&#x7684;&#x8981;&#x6C42;&#xFF1A;&#x4E00;&#x65E6;tracer&#x901A;&#x8FC7;ptrace_attach&#x4E86;&#x67D0;&#x4E2A;tracee&#xFF0C;&#x540E;&#x7EED;&#x53D1;&#x9001;&#x5230;&#x8BE5;tracee&#x7684;ptrace&#x8BF7;&#x6C42;&#x5FC5;&#x987B;&#x6765;&#x81EA;&#x540C;&#x4E00;&#x4E2A;tracer&#xFF0C;tracee&#x3001;tracer&#x5177;&#x4F53;&#x6307;&#x7684;&#x90FD;&#x662F;&#x7EBF;&#x7A0B;&#x3002;</p>
</blockquote>
<p>&#x5F53;&#x6211;&#x4EEC;&#x8C03;&#x7528;&#x4E86;attach&#x4E4B;&#x540E;&#xFF0C;attach&#x8FD4;&#x56DE;&#x65F6;&#xFF0C;tracee&#x6709;&#x53EF;&#x80FD;&#x8FD8;&#x6CA1;&#x6709;&#x505C;&#x4E0B;&#x6765;&#xFF0C;&#x8FD9;&#x4E2A;&#x65F6;&#x5019;&#x9700;&#x8981;&#x901A;&#x8FC7;wait&#x65B9;&#x6CD5;&#x6765;&#x7B49;&#x5F85;tracee&#x505C;&#x4E0B;&#x6765;&#xFF0C;&#x5E76;&#x83B7;&#x53D6;tracee&#x7684;&#x72B6;&#x6001;&#x4FE1;&#x606F;&#x3002;&#x5F53;&#x7ED3;&#x675F;&#x8C03;&#x8BD5;&#x65F6;&#xFF0C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;detach&#x64CD;&#x4F5C;&#xFF0C;&#x8BA9;tracee&#x6062;&#x590D;&#x6267;&#x884C;&#x3002;</p>
<blockquote>
<p>&#x4E0B;&#x9762;&#x662F;man&#x624B;&#x518C;&#x5173;&#x4E8E;ptrace&#x64CD;&#x4F5C;attach&#x3001;detach&#x7684;&#x8BF4;&#x660E;&#xFF0C;&#x4E0B;&#x9762;&#x8981;&#x7528;&#x5230;&#xFF1A;</p>
</blockquote>
<pre><code>**PTRACE_ATTACH**
*Attach to the process specified in pid, making it a tracee of*
*the calling process.  The tracee is sent a SIGSTOP, but will*
*not necessarily have stopped by the completion of this call;*
</code></pre><blockquote>
<p><em>use waitpid(2) to wait for the tracee to stop.  See the &quot;At&#x2010;</em>
<em>taching and detaching&quot; subsection for additional information.</em></p>
</blockquote>
<pre><code>**PTRACE_DETACH**
*Restart the stopped tracee as for PTRACE_CONT, but first de&#x2010;*
*tach from it.  Under Linux, a tracee can be detached in this*
*way regardless of which method was used to initiate tracing.*
</code></pre><h3 id="&#x4EE3;&#x7801;&#x5B9E;&#x73B0;">&#x4EE3;&#x7801;&#x5B9E;&#x73B0;</h3>
<p><strong>src&#x8BE6;&#x89C1;&#xFF1A;golang-debugger-lessons/2_process_attach</strong></p>
<p>file: main.go</p>
<pre><code class="lang-go"><span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> (
    <span class="hljs-string">&quot;fmt&quot;</span>
    <span class="hljs-string">&quot;os&quot;</span>
    <span class="hljs-string">&quot;os/exec&quot;</span>
    <span class="hljs-string">&quot;runtime&quot;</span>
    <span class="hljs-string">&quot;strconv&quot;</span>
    <span class="hljs-string">&quot;syscall&quot;</span>
    <span class="hljs-string">&quot;time&quot;</span>
)

<span class="hljs-keyword">const</span> (
    usage = <span class="hljs-string">&quot;Usage: go run main.go exec &lt;path/to/prog&gt;&quot;</span>

    cmdExec   = <span class="hljs-string">&quot;exec&quot;</span>
    cmdAttach = <span class="hljs-string">&quot;attach&quot;</span>
)

<span class="hljs-keyword">func</span> main() {
    <span class="hljs-comment">// issue: https://github.com/golang/go/issues/7699</span>
    <span class="hljs-comment">//</span>
    <span class="hljs-comment">// &#x4E3A;&#x4EC0;&#x4E48;syscall.PtraceDetach, detach error: no such process?</span>
    <span class="hljs-comment">// &#x56E0;&#x4E3A;ptrace&#x8BF7;&#x6C42;&#x5E94;&#x8BE5;&#x6765;&#x81EA;&#x76F8;&#x540C;&#x7684;tracer&#x7EBF;&#x7A0B;&#xFF0C;</span>
    <span class="hljs-comment">// </span>
    <span class="hljs-comment">// ps: &#x5982;&#x679C;&#x6070;&#x597D;&#x4E0D;&#x662F;&#xFF0C;&#x53EF;&#x80FD;&#x9700;&#x8981;&#x5BF9;tracee&#x7684;&#x72B6;&#x6001;&#x663E;&#x793A;&#x8FDB;&#x884C;&#x66F4;&#x590D;&#x6742;&#x7684;&#x5904;&#x7406;&#xFF0C;&#x9700;&#x8981;&#x8003;&#x8651;&#x4FE1;&#x53F7;&#xFF1F;</span>
    <span class="hljs-comment">// &#x76EE;&#x524D;&#x770B;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x4F20;&#x9012;&#x7684;&#x53C2;&#x6570;&#x662F;&#x8FD9;&#x6837;&#x3002;</span>
    runtime.LockOSThread()

    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(os.Args) &lt; <span class="hljs-number">3</span> {
        fmt.Fprintf(os.Stderr, <span class="hljs-string">&quot;%s\n\n&quot;</span>, usage)
        os.Exit(<span class="hljs-number">1</span>)
    }
    cmd := os.Args[<span class="hljs-number">1</span>]

    <span class="hljs-keyword">switch</span> cmd {
    <span class="hljs-keyword">case</span> cmdExec:
        prog := os.Args[<span class="hljs-number">2</span>]

        <span class="hljs-comment">// run prog</span>
        progCmd := exec.Command(prog)
        buf, err := progCmd.CombinedOutput()

        fmt.Fprintf(os.Stdout, <span class="hljs-string">&quot;tracee pid: %d\n&quot;</span>, progCmd.Process.Pid)

        <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
            fmt.Fprintf(os.Stderr, <span class="hljs-string">&quot;%s exec error: %v, \n\n%s\n\n&quot;</span>, err, <span class="hljs-keyword">string</span>(buf))
            os.Exit(<span class="hljs-number">1</span>)
        }
        fmt.Fprintf(os.Stdout, <span class="hljs-string">&quot;%s\n&quot;</span>, <span class="hljs-keyword">string</span>(buf))

    <span class="hljs-keyword">case</span> cmdAttach:
        pid, err := strconv.ParseInt(os.Args[<span class="hljs-number">2</span>], <span class="hljs-number">10</span>, <span class="hljs-number">64</span>)
        <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
            fmt.Fprintf(os.Stderr, <span class="hljs-string">&quot;%s invalid pid\n\n&quot;</span>, os.Args[<span class="hljs-number">2</span>])
            os.Exit(<span class="hljs-number">1</span>)
        }

        <span class="hljs-comment">// check pid</span>
        <span class="hljs-keyword">if</span> !checkPid(<span class="hljs-keyword">int</span>(pid)) {
            fmt.Fprintf(os.Stderr, <span class="hljs-string">&quot;process %d not existed\n\n&quot;</span>, pid)
            os.Exit(<span class="hljs-number">1</span>)
        }

        <span class="hljs-comment">// attach</span>
        err = syscall.PtraceAttach(<span class="hljs-keyword">int</span>(pid))
        <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
            fmt.Fprintf(os.Stderr, <span class="hljs-string">&quot;process %d attach error: %v\n\n&quot;</span>, pid, err)
            os.Exit(<span class="hljs-number">1</span>)
        }
        fmt.Fprintf(os.Stdout, <span class="hljs-string">&quot;process %d attach succ\n\n&quot;</span>, pid)

        <span class="hljs-comment">// wait</span>
        <span class="hljs-keyword">var</span> (
            status syscall.WaitStatus
            rusage syscall.Rusage
        )
        _, err = syscall.Wait4(<span class="hljs-keyword">int</span>(pid), &amp;status, syscall.WSTOPPED, &amp;rusage)
        <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
            fmt.Fprintf(os.Stderr, <span class="hljs-string">&quot;process %d wait error: %v\n\n&quot;</span>, pid, err)
            os.Exit(<span class="hljs-number">1</span>)
        }
        fmt.Fprintf(os.Stdout, <span class="hljs-string">&quot;process %d wait succ, status:%v, rusage:%v\n\n&quot;</span>, pid, status, rusage)

        <span class="hljs-comment">// detach</span>
        fmt.Printf(<span class="hljs-string">&quot;we&apos;re doing some debugging...\n&quot;</span>)
        time.Sleep(time.Second * <span class="hljs-number">10</span>)

        <span class="hljs-comment">// MUST: call runtime.LockOSThread() first</span>
        err = syscall.PtraceDetach(<span class="hljs-keyword">int</span>(pid))
        <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
            fmt.Fprintf(os.Stderr, <span class="hljs-string">&quot;process %d detach error: %v\n\n&quot;</span>, pid, err)
            os.Exit(<span class="hljs-number">1</span>)
        }
        fmt.Fprintf(os.Stdout, <span class="hljs-string">&quot;process %d detach succ\n\n&quot;</span>, pid)

    <span class="hljs-keyword">default</span>:
        fmt.Fprintf(os.Stderr, <span class="hljs-string">&quot;%s unknown cmd\n\n&quot;</span>, cmd)
        os.Exit(<span class="hljs-number">1</span>)
    }

}

<span class="hljs-comment">// checkPid check whether pid is valid process&apos;s id</span>
<span class="hljs-comment">//</span>
<span class="hljs-comment">// On Unix systems, os.FindProcess always succeeds and returns a Process for</span>
<span class="hljs-comment">// the given pid, regardless of whether the process exists.</span>
<span class="hljs-keyword">func</span> checkPid(pid <span class="hljs-keyword">int</span>) <span class="hljs-keyword">bool</span> {
    out, err := exec.Command(<span class="hljs-string">&quot;kill&quot;</span>, <span class="hljs-string">&quot;-s&quot;</span>, <span class="hljs-string">&quot;0&quot;</span>, strconv.Itoa(pid)).CombinedOutput()
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
        <span class="hljs-built_in">panic</span>(err)
    }

    <span class="hljs-comment">// output error message, means pid is invalid</span>
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">string</span>(out) != <span class="hljs-string">&quot;&quot;</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
    }

    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
}
</code></pre>
<p>&#x8FD9;&#x91CC;&#x7684;&#x7A0B;&#x5E8F;&#x903B;&#x8F91;&#x4E5F;&#x6BD4;&#x8F83;&#x7B80;&#x5355;&#xFF1A;</p>
<ul>
<li>&#x7A0B;&#x5E8F;&#x8FD0;&#x884C;&#x65F6;&#xFF0C;&#x9996;&#x5148;&#x68C0;&#x67E5;&#x547D;&#x4EE4;&#x884C;&#x53C2;&#x6570;&#xFF0C;<ul>
<li><code>godbg attach &lt;pid&gt;</code>&#xFF0C;&#x81F3;&#x5C11;&#x6709;3&#x4E2A;&#x53C2;&#x6570;&#xFF0C;&#x5982;&#x679C;&#x53C2;&#x6570;&#x6570;&#x91CF;&#x4E0D;&#x5BF9;&#xFF0C;&#x76F4;&#x63A5;&#x62A5;&#x9519;&#x9000;&#x51FA;&#xFF1B;</li>
<li>&#x63A5;&#x4E0B;&#x6765;&#x6821;&#x9A8C;&#x7B2C;2&#x4E2A;&#x53C2;&#x6570;&#xFF0C;&#x5982;&#x679C;&#x662F;&#x65E0;&#x6548;&#x7684;subcmd&#xFF0C;&#x4E5F;&#x76F4;&#x63A5;&#x62A5;&#x9519;&#x9000;&#x51FA;&#xFF1B;</li>
<li>&#x5982;&#x679C;&#x662F;attach&#xFF0C;&#x90A3;&#x4E48;pid&#x53C2;&#x6570;&#x5E94;&#x8BE5;&#x662F;&#x4E2A;&#x6574;&#x6570;&#xFF0C;&#x5982;&#x679C;&#x4E0D;&#x662F;&#x4E5F;&#x76F4;&#x63A5;&#x9000;&#x51FA;&#xFF1B;</li>
</ul>
</li>
<li>&#x53C2;&#x6570;&#x6B63;&#x5E38;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x5F00;&#x59CB;&#x5C1D;&#x8BD5;attach&#x5230;tracee&#xFF1B;</li>
<li>attach&#x4E4B;&#x540E;&#xFF0C;tracee&#x5E76;&#x4E0D;&#x4E00;&#x5B9A;&#x7ACB;&#x5373;&#x5C31;&#x4F1A;&#x505C;&#x4E0B;&#x6765;&#xFF0C;&#x9700;&#x8981;wait&#x6765;&#x83B7;&#x53D6;&#x5176;&#x72B6;&#x6001;&#x53D8;&#x5316;&#x60C5;&#x51B5;&#xFF1B;</li>
<li>&#x7B49;tracee&#x505C;&#x4E0B;&#x6765;&#x4E4B;&#x540E;&#xFF0C;&#x6211;&#x4EEC;&#x4F11;&#x7720;10s&#x949F;&#xFF0C;&#x4EFF;&#x4F5B;&#x81EA;&#x5DF1;&#x6B63;&#x5728;&#x5E72;&#x4E9B;&#x8C03;&#x8BD5;&#x64CD;&#x4F5C;&#x4E00;&#x6837;&#xFF1B;</li>
<li>10s&#x949F;&#x4E4B;&#x540E;&#xFF0C;tracer&#x5C1D;&#x8BD5;detach tracee&#xFF0C;&#x8BA9;tracee&#x7EE7;&#x7EED;&#x6062;&#x590D;&#x6267;&#x884C;&#x3002;</li>
</ul>
<p>&#x6211;&#x4EEC;&#x5728;Linux&#x5E73;&#x53F0;&#x4E0A;&#x5B9E;&#x73B0;&#x65F6;&#xFF0C;&#x9700;&#x8981;&#x8003;&#x8651;Linux&#x5E73;&#x53F0;&#x672C;&#x8EAB;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x5177;&#x4F53;&#x5305;&#x62EC;&#xFF1A;</p>
<ul>
<li>&#x68C0;&#x67E5;pid&#x662F;&#x5426;&#x5BF9;&#x5E94;&#x7740;&#x4E00;&#x4E2A;&#x6709;&#x6548;&#x7684;&#x8FDB;&#x7A0B;&#xFF0C;&#x901A;&#x5E38;&#x4F1A;&#x901A;&#x8FC7; <code>exec.FindProcess(pid)</code>&#x6765;&#x68C0;&#x67E5;&#xFF0C;&#x4F46;&#x662F;&#x5728;Unix&#x5E73;&#x53F0;&#x4E0B;&#xFF0C;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x603B;&#x662F;&#x8FD4;&#x56DE;OK&#xFF0C;&#x6240;&#x4EE5;&#x662F;&#x884C;&#x4E0D;&#x901A;&#x7684;&#x3002;&#x56E0;&#x6B64;&#x6211;&#x4EEC;&#x501F;&#x52A9;&#x4E86; <code>kill -s 0 pid</code>&#x8FD9;&#x4E00;&#x6BD4;&#x8F83;&#x7ECF;&#x5178;&#x7684;&#x505A;&#x6CD5;&#x6765;&#x68C0;&#x67E5;pid&#x5408;&#x6CD5;&#x6027;&#x3002;</li>
<li>tracer&#x3001;tracee&#x8FDB;&#x884C;detach&#x64CD;&#x4F5C;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x6211;&#x4EEC;&#x662F;&#x7528;&#x4E86;ptrace&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#xFF0C;&#x8FD9;&#x4E2A;&#x4E5F;&#x548C;&#x5E73;&#x53F0;&#x6709;&#x5173;&#x7CFB;&#xFF0C;&#x5982;Linux&#x5E73;&#x53F0;&#x4E0B;&#x7684;man&#x624B;&#x518C;&#x6709;&#x8BF4;&#x660E;&#xFF0C;&#x5FC5;&#x987B;&#x786E;&#x4FDD;&#x4E00;&#x4E2A;tracee&#x7684;&#x6240;&#x6709;&#x7684;ptrace requests&#x6765;&#x81EA;&#x76F8;&#x540C;&#x7684;tracer&#x7EBF;&#x7A0B;&#xFF0C;&#x5B9E;&#x73B0;&#x65F6;&#x5C31;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x8FD9;&#x70B9;&#x3002;</li>
</ul>
<h3 id="&#x4EE3;&#x7801;&#x6D4B;&#x8BD5;">&#x4EE3;&#x7801;&#x6D4B;&#x8BD5;</h3>
<p>&#x4E0B;&#x9762;&#x662F;&#x4E00;&#x4E2A;&#x6D4B;&#x8BD5;&#x793A;&#x4F8B;&#xFF0C;&#x5E2E;&#x52A9;&#x5927;&#x5BB6;&#x8FDB;&#x4E00;&#x6B65;&#x7406;&#x89E3;attach&#x3001;detach&#x7684;&#x4F5C;&#x7528;&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x5148;&#x5728;bash&#x542F;&#x52A8;&#x4E00;&#x4E2A;&#x547D;&#x4EE4;&#xFF0C;&#x8BA9;&#x5176;&#x4E00;&#x76F4;&#x8FD0;&#x884C;&#xFF0C;&#x7136;&#x540E;&#x83B7;&#x53D6;&#x5176;pid&#xFF0C;&#x5E76;&#x8BA9;godbg attach&#x5C06;&#x5176;&#x6302;&#x4F4F;&#xFF0C;&#x89C2;&#x5BDF;&#x7A0B;&#x5E8F;&#x7684;&#x6682;&#x505C;&#x3001;&#x6062;&#x590D;&#x6267;&#x884C;&#x3002;</p>
<p>&#x6BD4;&#x5982;&#xFF0C;&#x6211;&#x4EEC;&#x5728;bash&#x91CC;&#x9762;&#x5148;&#x6267;&#x884C;&#x4EE5;&#x4E0B;&#x547D;&#x4EE4;&#xFF0C;&#x5B83;&#x4F1A;&#x6BCF;&#x9694;1&#x79D2;&#x6253;&#x5370;&#x4E00;&#x4E0B;&#x5F53;&#x524D;&#x7684;pid&#xFF1A;</p>
<pre><code class="lang-bash">$ <span class="hljs-keyword">while</span> [ 1 <span class="hljs-_">-eq</span> 1 ]; <span class="hljs-keyword">do</span> t=`date`; <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$t</span> pid: $$&quot;</span>; sleep 1; <span class="hljs-keyword">done</span>

Sat Nov 14 14:29:04 UTC 2020 pid: 1311
Sat Nov 14 14:29:06 UTC 2020 pid: 1311
Sat Nov 14 14:29:07 UTC 2020 pid: 1311
Sat Nov 14 14:29:08 UTC 2020 pid: 1311
Sat Nov 14 14:29:09 UTC 2020 pid: 1311
Sat Nov 14 14:29:10 UTC 2020 pid: 1311
Sat Nov 14 14:29:11 UTC 2020 pid: 1311
Sat Nov 14 14:29:12 UTC 2020 pid: 1311
Sat Nov 14 14:29:13 UTC 2020 pid: 1311
Sat Nov 14 14:29:14 UTC 2020 pid: 1311  ==&gt; 14s
^C
</code></pre>
<p>&#x7136;&#x540E;&#x6211;&#x4EEC;&#x6267;&#x884C;&#x547D;&#x4EE4;&#xFF1A;</p>
<pre><code class="lang-bash">$ go run main.go attach 1311

process 1311 attach succ

process 1311 <span class="hljs-built_in">wait</span> succ, status:4991, rusage:{{12 607026} {4 42304} 43580 0 0 0 375739 348 0 68224 35656 0 0 0 29245 153787}

we<span class="hljs-string">&apos;re doing some debugging...           ==&gt; &#x8FD9;&#x91CC;sleep 10s
</span></code></pre>
<p>&#x6267;&#x884C;&#x5B8C;&#x4E0A;&#x8FF0;&#x547D;&#x4EE4;&#x540E;&#xFF0C;&#x56DE;&#x6765;&#x770B;shell&#x547D;&#x4EE4;&#x7684;&#x8F93;&#x51FA;&#x60C5;&#x51B5;&#xFF0C;&#x53EF;&#x89C1;&#x5176;&#x88AB;&#x6302;&#x8D77;&#x4E86;&#xFF0C;&#x7B49;&#x4E86;10s&#x4E4B;&#x540E;&#x53C8;&#x7EE7;&#x7EED;&#x6062;&#x590D;&#x6267;&#x884C;&#xFF0C;&#x8BF4;&#x660E;detach&#x4E4B;&#x540E;&#x53C8;&#x53EF;&#x4EE5;&#x7EE7;&#x7EED;&#x6267;&#x884C;&#x3002;</p>
<pre><code>Sat Nov 14 14:29:04 UTC 2020 pid: 1311
Sat Nov 14 14:29:06 UTC 2020 pid: 1311
Sat Nov 14 14:29:07 UTC 2020 pid: 1311
Sat Nov 14 14:29:08 UTC 2020 pid: 1311
Sat Nov 14 14:29:09 UTC 2020 pid: 1311
Sat Nov 14 14:29:10 UTC 2020 pid: 1311
Sat Nov 14 14:29:11 UTC 2020 pid: 1311
Sat Nov 14 14:29:12 UTC 2020 pid: 1311
Sat Nov 14 14:29:13 UTC 2020 pid: 1311
Sat Nov 14 14:29:14 UTC 2020 pid: 1311  ==&gt; at 14s, attached and stopped

Sat Nov 14 14:29:24 UTC 2020 pid: 1311  ==&gt; at 24s, detached and continued
Sat Nov 14 14:29:25 UTC 2020 pid: 1311
Sat Nov 14 14:29:26 UTC 2020 pid: 1311
Sat Nov 14 14:29:27 UTC 2020 pid: 1311
Sat Nov 14 14:29:28 UTC 2020 pid: 1311
Sat Nov 14 14:29:29 UTC 2020 pid: 1311
^C
</code></pre><p>&#x7136;&#x540E;&#x6211;&#x4EEC;&#x518D;&#x770B;&#x4E0B;&#x6211;&#x4EEC;&#x8C03;&#x8BD5;&#x5668;&#x7684;&#x8F93;&#x51FA;&#xFF0C;&#x53EF;&#x89C1;&#x5176;attach&#x3001;&#x6682;&#x505C;&#x3001;detach&#x903B;&#x8F91;&#xFF0C;&#x90FD;&#x662F;&#x6B63;&#x5E38;&#x7684;&#x3002;</p>
<pre><code class="lang-bash">$ go run main.go attach 1311

process 1311 attach succ

process 1311 <span class="hljs-built_in">wait</span> succ, status:4991, rusage:{{12 607026} {4 42304} 43580 0 0 0 375739 348 0 68224 35656 0 0 0 29245 153787}

we<span class="hljs-string">&apos;re doing some debugging...
process 1311 detach succ
</span></code></pre>
<h3 id="&#x95EE;&#x9898;&#x63A2;&#x8BA8;">&#x95EE;&#x9898;&#x63A2;&#x8BA8;</h3>
<p>&#x4E3A;&#x4E86;&#x8BA9;&#x8BFB;&#x8005;&#x80FD;&#x5FEB;&#x901F;&#x638C;&#x63E1;&#x6838;&#x5FC3;&#x8C03;&#x8BD5;&#x539F;&#x7406;&#xFF0C;&#x793A;&#x4F8B;&#x91CC;&#x6211;&#x4EEC;&#x6709;&#x610F;&#x7B80;&#x5316;&#x4E86;&#x793A;&#x4F8B;&#xFF0C;&#x5982;&#x88AB;&#x8C03;&#x8BD5;&#x8FDB;&#x7A0B;&#x662F;&#x4E00;&#x4E2A;&#x5355;&#x7EBF;&#x7A0B;&#x7A0B;&#x5E8F;&#xFF0C;&#x5982;&#x679C;&#x662F;&#x4E00;&#x4E2A;&#x591A;&#x7EBF;&#x7A0B;&#x7A0B;&#x5E8F;&#x7ED3;&#x679C;&#x4F1A;&#x4E0D;&#x4F1A;&#x4E0D;&#x4E00;&#x6837;&#x5462;&#xFF1F;&#x4F1A;&#xFF0C;&#x800C;&#x4E14;&#x6211;&#x4EEC;&#x8981;&#x505A;&#x4E00;&#x4E9B;&#x7279;&#x6B8A;&#x7684;&#x5904;&#x7406;&#x3002;&#x6211;&#x4EEC;&#x5728;&#x8FD9;&#x91CC;&#x8FDB;&#x4E00;&#x6B65;&#x8BA8;&#x8BBA;&#x4E0B;&#x3002;</p>
<h4 id="&#x95EE;&#x9898;&#xFF1A;&#x591A;&#x7EBF;&#x7A0B;&#x7A0B;&#x5E8F;attach&#x540E;&#x4ECD;&#x5728;&#x8FD0;&#x884C;&#xFF1F;">&#x95EE;&#x9898;&#xFF1A;&#x591A;&#x7EBF;&#x7A0B;&#x7A0B;&#x5E8F;attach&#x540E;&#x4ECD;&#x5728;&#x8FD0;&#x884C;&#xFF1F;</h4>
<p>&#x6709;&#x8BFB;&#x8005;&#x53EF;&#x80FD;&#x4F1A;&#x81EA;&#x5DF1;&#x5F00;&#x53D1;&#x4E00;&#x4E2A;go&#x7A0B;&#x5E8F;&#x4F5C;&#x4E3A;&#x88AB;&#x8C03;&#x8BD5;&#x7A0B;&#x5E8F;&#xFF0C;&#x671F;&#x95F4;&#x53EF;&#x80FD;&#x4F1A;&#x9047;&#x5230;&#x591A;&#x7EBF;&#x7A0B;&#x7ED9;&#x8C03;&#x8BD5;&#x5E26;&#x6765;&#x7684;&#x4E00;&#x4E9B;&#x56F0;&#x60D1;&#xFF0C;&#x8FD9;&#x91CC;&#x4E5F;&#x63D0;&#x4E00;&#x4E0B;&#x3002;</p>
<p>&#x5047;&#x5982;&#x6211;&#x4F7F;&#x7528;&#x4E0B;&#x9762;&#x7684;go&#x7A0B;&#x5E8F;&#x505A;&#x4E3A;&#x88AB;&#x8C03;&#x8BD5;&#x7A0B;&#x5E8F;&#xFF1A;</p>
<pre><code class="lang-go"><span class="hljs-keyword">import</span> (
    <span class="hljs-string">&quot;fmt&quot;</span>
    <span class="hljs-string">&quot;time&quot;</span>
    <span class="hljs-string">&quot;os&quot;</span>
)
<span class="hljs-keyword">func</span> main() {
    <span class="hljs-keyword">for</span>  {
        time.Sleep(time.Second)
        fmt.Println(<span class="hljs-string">&quot;pid:&quot;</span>, os.Getpid())
    }
}
</code></pre>
<p>&#x7ED3;&#x679C;&#x53D1;&#x73B0;&#x6267;&#x884C;&#x4E86; <code>godbg attach &lt;pid&gt;</code>&#x4E4B;&#x540E;&#x7A0B;&#x5E8F;&#x8FD8;&#x5728;&#x6267;&#x884C;&#xFF0C;&#x8FD9;&#x662F;&#x4E3A;&#x4EC0;&#x4E48;&#x5462;&#xFF1F;</p>
<p>&#x56E0;&#x4E3A;go&#x7A0B;&#x5E8F;&#x5929;&#x7136;&#x662F;&#x591A;&#x7EBF;&#x7A0B;&#x7A0B;&#x5E8F;&#xFF0C;sysmon&#x3001;gc&#x7B49;&#x7B49;&#x90FD;&#x53EF;&#x80FD;&#x4F1A;&#x7528;&#x5230;&#x72EC;&#x7ACB;&#x7EBF;&#x7A0B;&#xFF0C;&#x6211;&#x4EEC;attach&#x65F6;&#x53EA;&#x662F;&#x7B80;&#x5355;&#x7684;attach&#x4E86;pid&#x5BF9;&#x5E94;&#x8FDB;&#x7A0B;&#x7684;&#x67D0;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#xFF0C;&#x5176;&#x4ED6;&#x7684;&#x7EBF;&#x7A0B;&#x4ECD;&#x7136;&#x662F;&#x6CA1;&#x6709;&#x88AB;&#x8C03;&#x8BD5;&#x8DDF;&#x8E2A;&#x7684;&#xFF0C;&#x662F;&#x53EF;&#x4EE5;&#x6B63;&#x5E38;&#x6267;&#x884C;&#x7684;&#x3002;</p>
<p>&#x90A3;&#x6211;&#x4EEC;ptrace&#x65F6;&#x6307;&#x5B9A;&#x4E86;pid&#x5230;&#x5E95;attach&#x4E86;&#x54EA;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x5462;&#xFF1F;<strong>&#x8FD9;&#x4E2A;pid&#x5BF9;&#x5E94;&#x7684;&#x7EBF;&#x7A0B;&#x96BE;&#x9053;&#x4E0D;&#x662F;&#x6267;&#x884C;main.main&#x7684;&#x7EBF;&#x7A0B;&#x5417;&#xFF1F;&#x5148;&#x56DE;&#x7B54;&#x8BFB;&#x8005;&#x95EE;&#x9898;&#xFF1A;&#x6CA1;&#x9519;&#xFF0C;&#x8FD8;&#x771F;&#x4E0D;&#x4E00;&#x5B9A;&#x662F;&#xFF01;</strong></p>
<p><strong>go&#x7A0B;&#x5E8F;&#x4E2D;&#x51FD;&#x6570;main.main&#x662F;&#x7531;main goroutine&#x6765;&#x6267;&#x884C;&#x7684;&#xFF0C;&#x4F46;&#x662F;main goroutine&#x5E76;&#x6CA1;&#x6709;&#x548C;main thread&#x5B58;&#x5728;&#x4EFB;&#x4F55;&#x9ED8;&#x8BA4;&#x7684;&#x7ED1;&#x5B9A;&#x5173;&#x7CFB;</strong>&#x3002;&#x6240;&#x4EE5;&#x8BA4;&#x4E3A;main.main&#x4E00;&#x5B9A;&#x8FD0;&#x884C;&#x5728;pid&#x5BF9;&#x5E94;&#x7684;&#x7EBF;&#x7A0B;&#x4E4B;&#x4E0A;&#x662F;&#x9519;&#x8BEF;&#x7684;&#xFF01;</p>
<blockquote>
<p>ps&#xFF1A;&#x9644;&#x5F55;&#x300A;go runtime: go&#x7A0B;&#x5E8F;&#x542F;&#x52A8;&#x6D41;&#x7A0B;&#x300B;&#x4E2D;&#x5BF9;go&#x7A0B;&#x5E8F;&#x7684;&#x542F;&#x52A8;&#x6D41;&#x7A0B;&#x505A;&#x4E86;&#x5206;&#x6790;&#xFF0C;&#x53EF;&#x4EE5;&#x5E2E;&#x8BFB;&#x8005;&#x670B;&#x53CB;&#x6253;&#x6D88;&#x8FD9;&#x91CC;main.main&#x3001;main goroutine&#x3001;main thread&#x7684;&#x4E00;&#x4E9B;&#x7591;&#x8651;&#x3002;</p>
</blockquote>
<p>&#x5728;Linux&#x4E0B;&#xFF0C;&#x7EBF;&#x7A0B;&#x5176;&#x5B9E;&#x662F;&#x901A;&#x8FC7;&#x8F7B;&#x91CF;&#x7EA7;&#x8FDB;&#x7A0B;&#xFF08;LWP&#xFF09;&#x6765;&#x5B9E;&#x73B0;&#x7684;&#xFF0C;&#x8FD9;&#x91CC;&#x7684;ptrace&#x53C2;&#x6570;pid&#x5B9E;&#x9645;&#x4E0A;&#x662F;&#x7EBF;&#x7A0B;&#x5BF9;&#x5E94;&#x7684;LWP&#x7684;&#x8FDB;&#x7A0B;id&#x3002;&#x53EA;&#x5BF9;&#x8FDB;&#x7A0B;pid&#x8FDB;&#x884C;ptrace attach&#x64CD;&#x4F5C;&#xFF0C;&#x7ED3;&#x679C;&#x662F;&#x5C06;&#x53EA;&#x6709;&#x8FD9;&#x4E2A;&#x8FDB;&#x7A0B;pid&#x5BF9;&#x5E94;&#x7684;&#x7EBF;&#x7A0B;&#x4F1A;&#x88AB;&#x8C03;&#x8BD5;&#x8DDF;&#x8E2A;&#x3002;</p>
<p><strong>&#x5728;&#x8C03;&#x8BD5;&#x573A;&#x666F;&#x4E2D;&#xFF0C;tracee&#x6307;&#x7684;&#x662F;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#xFF0C;&#x800C;&#x975E;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x5305;&#x542B;&#x7684;&#x6240;&#x6709;&#x7EBF;&#x7A0B;</strong>&#xFF0C;&#x5C3D;&#x7BA1;&#x6211;&#x4EEC;&#x6709;&#x65F6;&#x5019;&#x4E3A;&#x4E86;&#x63CF;&#x8FF0;&#x65B9;&#x4FBF;&#xFF0C;&#x5728;&#x672F;&#x8BED;&#x4E0A;&#x4F1A;&#x9009;&#x62E9;&#x503E;&#x5411;&#x4E8E;&#x4F7F;&#x7528;&#x8FDB;&#x7A0B;&#x3002;</p>
<blockquote>
<p>&#x4E00;&#x4E2A;&#x591A;&#x7EBF;&#x7A0B;&#x7684;&#x8FDB;&#x7A0B;&#xFF0C;&#x5176;&#x5B9E;&#x662F;&#x53EF;&#x4EE5;&#x7406;&#x89E3;&#x6210;&#x4E00;&#x4E2A;&#x5305;&#x542B;&#x4E86;&#x591A;&#x4E2A;&#x7EBF;&#x7A0B;&#x7684;&#x7EBF;&#x7A0B;&#x7EC4;&#xFF0C;&#x7EBF;&#x7A0B;&#x7EC4;&#x4E2D;&#x7684;&#x7EBF;&#x7A0B;&#x5728;&#x521B;&#x5EFA;&#x7684;&#x65F6;&#x5019;&#x90FD;&#x901A;&#x8FC7;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;clone+&#x53C2;&#x6570;CLONE_THREAD&#x6765;&#x521B;&#x5EFA;&#xFF0C;&#x6765;&#x4FDD;&#x8BC1;&#x6240;&#x6709;&#x65B0;&#x521B;&#x5EFA;&#x7684;&#x7EBF;&#x7A0B;&#x62E5;&#x6709;&#x76F8;&#x540C;&#x7684;pid&#xFF0C;&#x7C7B;&#x4F3C;clone+CLONE_PARENT&#x4F7F;&#x5F97;&#x514B;&#x9686;&#x51FA;&#x7684;&#x6240;&#x6709;&#x5B50;&#x8FDB;&#x7A0B;&#x90FD;&#x6709;&#x76F8;&#x540C;&#x7684;&#x7236;&#x8FDB;&#x7A0B;id&#x4E00;&#x6837;&#x3002;</p>
<p>golang&#x91CC;&#x9762;&#x901A;&#x8FC7;clone&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x4EE5;&#x53CA;&#x5982;&#x4E0B;&#x9009;&#x9879;&#x6765;&#x521B;&#x5EFA;&#x7EBF;&#x7A0B;&#xFF1A;</p>
<pre><code class="lang-go">
cloneFlags = _CLONE_VM | <span class="hljs-comment">/* share memory */</span>
    _CLONE_FS | <span class="hljs-comment">/* share cwd, etc */</span>
    _CLONE_FILES | <span class="hljs-comment">/* share fd table */</span>
    _CLONE_SIGHAND | <span class="hljs-comment">/* share sig handler table */</span>
    _CLONE_SYSVSEM | <span class="hljs-comment">/* share SysV semaphore undo lists (see issue #20763) */</span>
    _CLONE_THREAD <span class="hljs-comment">/* revisit - okay for now */</span>
</code></pre>
<p>&#x5173;&#x4E8E;clone&#x9009;&#x9879;&#x7684;&#x66F4;&#x591A;&#x4F5C;&#x7528;&#xFF0C;&#x60A8;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x67E5;&#x770B;man&#x624B;&#x518C; <code>man 2 clone</code>&#x6765;&#x4E86;&#x89E3;&#x3002;</p>
</blockquote>
<p>pid&#x6807;&#x8BC6;&#x7684;&#x7EBF;&#x7A0B;&#xFF08;&#x6216;LWP&#xFF09;&#x4E0E;&#x53D1;&#x9001;ptrace&#x8BF7;&#x6C42;&#x7684;&#x7EBF;&#x7A0B;&#xFF08;&#x6216;LWP&#xFF09;&#x4E8C;&#x8005;&#x4E4B;&#x95F4;&#x5EFA;&#x7ACB;ptrace link&#xFF0C;&#x5B83;&#x4EEC;&#x7684;&#x89D2;&#x8272;&#x5206;&#x522B;&#x4E3A;tracee&#x3001;tracer&#xFF0C;&#x540E;&#x7EED;tracee&#x671F;&#x671B;&#x6536;&#x5230;&#x7684;&#x6240;&#x6709;ptrace&#x8BF7;&#x6C42;&#x90FD;&#x6765;&#x81EA;&#x8FD9;&#x4E2A;tracer&#x3002;&#x56E0;&#x4E3A;&#x8FD9;&#x4E2A;&#x539F;&#x56E0;&#xFF0C;&#x5929;&#x7136;&#x5C31;&#x662F;&#x591A;&#x7EBF;&#x7A0B;&#x7684;go&#x7A0B;&#x5E8F;&#x5C31;&#x9700;&#x8981;&#x4FDD;&#x8BC1;&#x5B9E;&#x9645;&#x53D1;&#x9001;ptrace&#x8BF7;&#x6C42;&#x7684;goroutine&#x5FC5;&#x987B;&#x6267;&#x884C;&#x5728;&#x540C;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x4E0A;&#x3002;</p>
<p>&#x88AB;&#x8C03;&#x8BD5;&#x8FDB;&#x7A0B;&#x4E2D;&#x5982;&#x679C;&#x6709;&#x5176;&#x4ED6;&#x7EBF;&#x7A0B;&#xFF0C;&#x4ECD;&#x7136;&#x662F;&#x53EF;&#x4EE5;&#x8FD0;&#x884C;&#x7684;&#xFF0C;&#x8FD9;&#x5C31;&#x662F;&#x4E3A;&#x4EC0;&#x4E48;&#x6211;&#x4EEC;&#x67D0;&#x4E9B;&#x8BFB;&#x8005;&#x53D1;&#x73B0;&#x6709;&#x65F6;&#x5019;&#x88AB;&#x8C03;&#x8BD5;&#x7A0B;&#x5E8F;&#x4ECD;&#x7136;&#x5728;&#x4E0D;&#x505C;&#x8F93;&#x51FA;&#xFF0C;&#x56E0;&#x4E3A;tracer&#x5E76;&#x6CA1;&#x6709;&#x5728;main.main&#x5185;&#x90E8;&#x8BBE;&#x7F6E;&#x65AD;&#x70B9;&#xFF0C;&#x6267;&#x884C;&#x8BE5;&#x51FD;&#x6570;&#x7684;main goroutine&#x53EF;&#x80FD;&#x7531;&#x5176;&#x4ED6;&#x672A;&#x88AB;trace&#x7684;&#x7EBF;&#x7A0B;&#x6267;&#x884C;&#xFF0C;&#x6240;&#x4EE5;&#x4ECD;&#x7136;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x7A0B;&#x5E8F;&#x4E0D;&#x505C;&#x8F93;&#x51FA;&#x3002;</p>
<h4 id="&#x95EE;&#x9898;&#xFF1A;&#x60F3;&#x8BA9;&#x6267;&#x884C;mainmain&#x7684;&#x7EBF;&#x7A0B;&#x505C;&#x4E0B;&#x6765;&#xFF1F;">&#x95EE;&#x9898;&#xFF1A;&#x60F3;&#x8BA9;&#x6267;&#x884C;main.main&#x7684;&#x7EBF;&#x7A0B;&#x505C;&#x4E0B;&#x6765;&#xFF1F;</h4>
<p>&#x5982;&#x679C;&#x60F3;&#x8BA9;&#x88AB;&#x8C03;&#x8BD5;&#x8FDB;&#x7A0B;&#x505C;&#x6B62;&#x6267;&#x884C;&#xFF0C;&#x8C03;&#x8BD5;&#x5668;&#x9700;&#x8981;&#x679A;&#x4E3E;&#x8FDB;&#x7A0B;&#x4E2D;&#x5305;&#x542B;&#x7684;&#x7EBF;&#x7A0B;&#x5E76;&#x5BF9;&#x5B83;&#x4EEC;&#x9010;&#x4E00;&#x8FDB;&#x884C;ptrace attach&#x64CD;&#x4F5C;&#x3002;&#x5177;&#x4F53;&#x5230;Linux&#xFF0C;&#x53EF;&#x4EE5;&#x5217;&#x51FA; <code>/proc/&lt;pid&gt;/task</code>&#x4E0B;&#x7684;&#x6240;&#x6709;&#x7EBF;&#x7A0B;&#xFF08;&#x6216;LWP&#xFF09;&#x7684;pid&#xFF0C;&#x9010;&#x4E2A;&#x6267;&#x884C;ptrace attach&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x5C06;&#x5728;&#x540E;&#x7EED;&#x8FC7;&#x7A0B;&#x4E2D;&#x8FDB;&#x4E00;&#x6B65;&#x5B8C;&#x5584;attach&#x547D;&#x4EE4;&#xFF0C;&#x4F7F;&#x5176;&#x4E5F;&#x80FD;&#x80DC;&#x4EFB;&#x591A;&#x7EBF;&#x7A0B;&#x73AF;&#x5883;&#x4E0B;&#x7684;&#x8C03;&#x8BD5;&#x5DE5;&#x4F5C;&#x3002;</p>
<h4 id="&#x95EE;&#x9898;&#xFF1A;&#x5982;&#x4F55;&#x5224;&#x65AD;&#x8FDB;&#x7A0B;&#x662F;&#x5426;&#x662F;&#x591A;&#x7EBF;&#x7A0B;&#x7A0B;&#x5E8F;&#xFF1F;">&#x95EE;&#x9898;&#xFF1A;&#x5982;&#x4F55;&#x5224;&#x65AD;&#x8FDB;&#x7A0B;&#x662F;&#x5426;&#x662F;&#x591A;&#x7EBF;&#x7A0B;&#x7A0B;&#x5E8F;&#xFF1F;</h4>
<p>&#x5982;&#x4F55;&#x5224;&#x65AD;&#x76EE;&#x6807;&#x8FDB;&#x7A0B;&#x662F;&#x5426;&#x662F;&#x591A;&#x7EBF;&#x7A0B;&#x7A0B;&#x5E8F;&#x5462;&#xFF1F;&#x6709;&#x4E24;&#x79CD;&#x7B80;&#x5355;&#x7684;&#x529E;&#x6CD5;&#x5E2E;&#x52A9;&#x5224;&#x65AD;&#x3002;</p>
<ul>
<li><p><code>top -H -p pid</code></p>
<p><code>-H</code>&#x9009;&#x9879;&#x5C06;&#x5217;&#x51FA;&#x8FDB;&#x7A0B;pid&#x4E0B;&#x7684;&#x7EBF;&#x7A0B;&#x5217;&#x8868;&#xFF0C;&#x4EE5;&#x4E0B;&#x8FDB;&#x7A0B;5293&#x4E0B;&#x6709;4&#x4E2A;&#x7EBF;&#x7A0B;&#xFF0C;Linux&#x4E0B;&#x7EBF;&#x7A0B;&#x662F;&#x901A;&#x8FC7;&#x8F7B;&#x91CF;&#x7EA7;&#x8FDB;&#x7A0B;&#x5B9E;&#x73B0;&#x7684;&#xFF0C;PID&#x5217;&#x4E3A;5293&#x7684;&#x8F7B;&#x91CF;&#x7EA7;&#x8FDB;&#x7A0B;&#x4E3A;&#x4E3B;&#x7EBF;&#x7A0B;&#x3002;</p>
<pre><code class="lang-bash">$ top -H -p 5293
........
PID USER      PR  NI    VIRT    RES    SHR S %CPU %MEM     TIME+ COMMAND                                                     
 5293 root      20   0  702968   1268    968 S  0.0  0.0   0:00.04 loop                                                        
 5294 root      20   0  702968   1268    968 S  0.0  0.0   0:00.08 loop                                                        
 5295 root      20   0  702968   1268    968 S  0.0  0.0   0:00.03 loop                                                        
 5296 root      20   0  702968   1268    968 S  0.0  0.0   0:00.03 loop
</code></pre>
<p>top&#x5C55;&#x793A;&#x4FE1;&#x606F;&#x4E2D;&#x5217;S&#x8868;&#x793A;&#x8FDB;&#x7A0B;&#x72B6;&#x6001;&#xFF0C;&#x5E38;&#x89C1;&#x7684;&#x53D6;&#x503C;&#x53CA;&#x542B;&#x4E49;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre><code class="lang-bash"><span class="hljs-string">&apos;D&apos;</span> = uninterruptible sleep
<span class="hljs-string">&apos;R&apos;</span> = running
<span class="hljs-string">&apos;S&apos;</span> = sleeping
<span class="hljs-string">&apos;T&apos;</span> = traced or stopped
<span class="hljs-string">&apos;Z&apos;</span> = zombie
</code></pre>
<p>&#x901A;&#x8FC7;&#x72B6;&#x6001; <strong>&apos;T&apos;</strong> &#x53EF;&#x4EE5;&#x8BC6;&#x522B;&#x591A;&#x7EBF;&#x7A0B;&#x7A0B;&#x5E8F;&#x4E2D;&#x54EA;&#x4E9B;&#x7EBF;&#x7A0B;&#x6B63;&#x5728;&#x88AB;&#x8C03;&#x8BD5;&#x8DDF;&#x8E2A;&#x3002;</p>
</li>
<li><p><code>ls /proc/&lt;pid&gt;/task</code></p>
<pre><code class="lang-bash">$ ls /proc/5293/task/

5293/ 5294/ 5295/ 5296/
</code></pre>
<p>Linux&#x4E0B;/proc&#x662F;&#x4E00;&#x4E2A;&#x865A;&#x62DF;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#xFF0C;&#x5B83;&#x91CC;&#x9762;&#x5305;&#x542B;&#x4E86;&#x7CFB;&#x7EDF;&#x8FD0;&#x884C;&#x65F6;&#x7684;&#x5404;&#x79CD;&#x72B6;&#x6001;&#x4FE1;&#x606F;&#xFF0C;&#x4EE5;&#x4E0B;&#x547D;&#x4EE4;&#x53EF;&#x4EE5;&#x67E5;&#x770B;&#x5230;&#x8FDB;&#x7A0B;5293&#x4E0B;&#x7684;&#x7EBF;&#x7A0B;&#x3002;&#x548C;top&#x5C55;&#x793A;&#x7684;&#x7ED3;&#x679C;&#x662F;&#x4E00;&#x6837;&#x7684;&#x3002;</p>
</li>
</ul>
<h4 id="&#x95EE;&#x9898;&#xFF1A;syscallwait4&#x7684;&#x53C2;&#x6570;&#x8BF4;&#x660E;">&#x95EE;&#x9898;&#xFF1A;syscall.Wait4&#x7684;&#x53C2;&#x6570;&#x8BF4;&#x660E;</h4>
<p>Linux&#x7CFB;&#x7EDF;&#x6709;&#x591A;&#x4E2A;&#x7B49;&#x5F85;&#x8FDB;&#x7A0B;&#x72B6;&#x6001;&#x6539;&#x53D8;&#x7684;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#xFF0C;&#x5B83;&#x4EEC;&#x6709;&#x4E00;&#x4E9B;&#x4F7F;&#x7528;&#x3001;&#x529F;&#x80FD;&#x4E0A;&#x7684;&#x7EC6;&#x5FAE;&#x5DEE;&#x522B;&#xFF0C;&#x6211;&#x4EEC;&#x8FD9;&#x91CC;&#x4F7F;&#x7528;syscall.Wait4&#x521A;&#x597D;&#x5BF9;&#x5E94;&#x7740;Linux&#x7CFB;&#x7EDF;&#x8C03;&#x7528;wait4&#xFF0C;&#x8BE6;&#x7EC6;&#x7684;&#x4F7F;&#x7528;&#x8BF4;&#x660E;&#x53EF;&#x4EE5;&#x53C2;&#x8003;man&#x624B;&#x518C;&#x3002;</p>
<p>man&#x624B;&#x518C;&#x8BF4;&#x660E;&#x4E2D;&#x5F3A;&#x76F8;&#x5173;&#x7684;&#x90E8;&#x5206;&#xFF0C;&#x5982;&#x4E0B;&#x6240;&#x793A;&#xFF1A;</p>
<p>man 2 wait4</p>
<blockquote>
<p><strong>Name</strong></p>
<p><em>wait3, wait4 - wait for process to change state, BSD style</em></p>
<p><strong>SYNOPSIS</strong></p>
<p>pid_t wait3(int <em>wstatus, int options,
struct rusage </em>rusage);</p>
<p>pid_t wait4(pid_t pid, int <em>wstatus, int options,
struct rusage </em>rusage);</p>
<p><strong>Description</strong></p>
<p><strong>These functions are obsolete; use waitpid(2) or waitid(2) in new programs.</strong></p>
<p>The wait3() and wait4() system calls are similar to waitpid(2), but additionally return resource usage information about the child in the structure pointed to by rusage.</p>
</blockquote>
<p>man 2 waitpid</p>
<blockquote>
<p><strong>Name</strong></p>
<p>wait, waitpid, waitid - wait for process to change state</p>
<p><strong>SYNOPSIS</strong></p>
<p>pid_t wait(int *wstatus);</p>
<p>pid_t waitpid(pid_t pid, int *wstatus, int options);</p>
<p>int waitid(idtype_t idtype, id_t id, siginfo_t<em>infop, int options);
/</em> This is the glibc and POSIX interface; see
NOTES for information on the raw system call. */</p>
<p><strong>SYNOPSIS</strong></p>
<p>All  of  these  system calls are used to wait for state changes in a child of the calling process, and obtain information about the child whose state has changed.  A state change is considered to be: the child terminated;
the child was stopped by a signal; or the child was resumed by a signal.  In the case of a terminated child, performing a wait allows the system to release the resources associated with the child; if a wait  is  not  per&#x2010;
formed, then the terminated child remains in a &quot;zombie&quot; state (see NOTES below).</p>
<p>If  a  child  has already changed state, then these calls return immediately.  Otherwise, they block until either a child changes state or a signal handler interrupts the call (assuming that system calls are not automati&#x2010;
cally restarted using the SA_RESTART flag of sigaction(2)).  In the remainder of this page, a child whose state has changed and which has not yet been waited upon by one of these system calls is termed waitable.</p>
<p>wait() and waitpid()
The wait() system call suspends execution of the calling process until one of its children terminates.  The call wait(&amp;wstatus) is equivalent to:</p>
<p>waitpid(-1, &amp;wstatus, 0);</p>
<p>The waitpid() system call suspends execution of the calling process until a child specified by pid argument has changed state.  By default, waitpid() waits only for terminated children, but this behavior is modifiable via
the options argument, as described below.</p>
<p>The value of pid can be:</p>
<ul>
<li>\&lt;-1: meaning wait for any child process whose process group ID is equal to the absolute value of pid.</li>
<li>-1: meaning wait for any child process.</li>
<li>0: meaning wait for any child process whose process group ID is equal to that of the calling process.</li>
<li>&gt;0: meaning wait for the child whose process ID is equal to the value of pid.</li>
</ul>
<p>The value of options is an OR of zero or more of the following constants:</p>
<ul>
<li>WNOHANG: ... blabla</li>
<li>WUNTRACED: ... blabla</li>
<li>WCONTINUED: ... blabla</li>
</ul>
<p>(For Linux-only options, see below.)</p>
<ul>
<li>WIFSTOPPED: returns true if the child process was stopped by delivery of a signal; this is possible only if the call was done using WUNTRACED or when the child is being traced (see ptrace(2)).</li>
<li>... blabla</li>
</ul>
</blockquote>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="1-process_start.html" class="navigation navigation-prev " aria-label="Previous page: 6.1 进程启动">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="3-process_start_attach.html" class="navigation navigation-next " aria-label="Next page: 6.3 启动&attach">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"6.2 进程attach","level":"1.6.2","depth":2,"next":{"title":"6.3 启动&attach","level":"1.6.3","depth":2,"path":"6-develop-inst-debugger/3-process_start_attach.md","ref":"6-develop-inst-debugger/3-process_start_attach.md","articles":[]},"previous":{"title":"6.1 进程启动","level":"1.6.1","depth":2,"path":"6-develop-inst-debugger/1-process_start.md","ref":"6-develop-inst-debugger/1-process_start.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["numbered-headings","github","intopic-toc","splitter","-lunr","-search","search-pro"],"pluginsConfig":{"disqus":{"shortName":"gitbookuse"},"github":{"url":"https://github.com/hitzhangjie/golang-debugger-book"},"intopic-toc":{"isCollapsed":false,"isScrollspyActive":false,"label":"本文目录","maxDepth":6,"mode":"nested","selector":".markdown-section h1, .markdown-section h2, .markdown-section h3, .markdown-section h4, .markdown-section h5, .markdown-section h6","visible":true},"splitter":{},"search-pro":{},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"numbered-headings":{},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"6-develop-inst-debugger/2-process_attach.md","mtime":"2025-08-15T09:48:22.304Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2025-08-15T09:48:55.015Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-github/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-intopic-toc/anchor.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-intopic-toc/gumshoe.polyfills.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-intopic-toc/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-splitter/splitter.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search-pro/jquery.mark.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search-pro/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

